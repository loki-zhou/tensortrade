{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0197716916440633, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.10000000000000002, "total_loss": 0.30170789361200345, "policy_loss": -0.2002713174919688, "vf_loss": 0.9976628721401256, "vf_explained_var": 0.00034183565006461197, "kl": 0.04811937877468578, "entropy": 0.647609955328767, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 21.0, "episode_reward_min": -30.0, "episode_reward_mean": -4.285714285714286, "episode_len_mean": 523.5714285714286, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33609016750252746, "mean_inference_ms": 1.0899766866221068, "mean_action_processing_ms": 0.11499820128586016, "mean_env_wait_ms": 0.6376672643210047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.001399857657296317, "ObsPreprocessorConnector_ms": 0.014281272888183594, "MeanStdObservationFilterAgentConnector_ms": 0.044539996555873325, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1014573233468192}}, "episode_reward_max": 21.0, "episode_reward_min": -30.0, "episode_reward_mean": -4.285714285714286, "episode_len_mean": 523.5714285714286, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33609016750252746, "mean_inference_ms": 1.0899766866221068, "mean_action_processing_ms": 0.11499820128586016, "mean_env_wait_ms": 0.6376672643210047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.001399857657296317, "ObsPreprocessorConnector_ms": 0.014281272888183594, "MeanStdObservationFilterAgentConnector_ms": 0.044539996555873325, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1014573233468192}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 13929.067, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 5126.84, "learn_throughput": 780.208, "synch_weights_time_ms": 1.897}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 7, "training_iteration": 1, "trial_id": "bfbe5_00000", "experiment_id": "9d397f7cc24449e6a0a9d132139c82a3", "date": "2023-03-20_16-11-29", "timestamp": 1679299889, "time_this_iter_s": 13.941367387771606, "time_total_s": 13.941367387771606, "pid": 20684, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002BA012614C0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x000002BA01102430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13.941367387771606, "timesteps_since_restore": 0, "iterations_since_restore": 1, "warmup_time": 6.740259885787964, "perf": {"cpu_util_percent": 22.82, "ram_util_percent": 58.53499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2236381889831636, "cur_kl_coeff": 0.3, "cur_lr": 0.0007, "total_loss": 0.21609838314915217, "policy_loss": -0.25681673219447493, "vf_loss": 0.8803386344063666, "vf_explained_var": 0.01278714902939335, "kl": 0.12172831332780762, "entropy": 0.37726968852102116, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 351.0, "episode_reward_min": -30.0, "episode_reward_mean": 98.0, "episode_len_mean": 659.1818181818181, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3359119682518722, "mean_inference_ms": 1.091244153104273, "mean_action_processing_ms": 0.11565364405818884, "mean_env_wait_ms": 0.6343117425345008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0008908185091885654, "ObsPreprocessorConnector_ms": 0.009088082747025923, "MeanStdObservationFilterAgentConnector_ms": 0.028343634171919388, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09208809245716441}}, "episode_reward_max": 351.0, "episode_reward_min": -30.0, "episode_reward_mean": 98.0, "episode_len_mean": 659.1818181818181, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3359119682518722, "mean_inference_ms": 1.091244153104273, "mean_action_processing_ms": 0.11565364405818884, "mean_env_wait_ms": 0.6343117425345008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0008908185091885654, "ObsPreprocessorConnector_ms": 0.009088082747025923, "MeanStdObservationFilterAgentConnector_ms": 0.028343634171919388, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09208809245716441}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 13983.674, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 5204.222, "learn_throughput": 768.607, "synch_weights_time_ms": 1.95}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 11, "training_iteration": 2, "trial_id": "bfbe5_00000", "experiment_id": "9d397f7cc24449e6a0a9d132139c82a3", "date": "2023-03-20_16-11-43", "timestamp": 1679299903, "time_this_iter_s": 14.05028247833252, "time_total_s": 27.991649866104126, "pid": 20684, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002BA012C9C10>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x000002B8CDB45820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 27.991649866104126, "timesteps_since_restore": 0, "iterations_since_restore": 2, "warmup_time": 6.740259885787964, "perf": {"cpu_util_percent": 25.605, "ram_util_percent": 58.59999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7447777621608268, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0003, "total_loss": 0.11671440613516156, "policy_loss": -0.13489216976769028, "vf_loss": 0.4798928896265645, "vf_explained_var": 0.030264737016411237, "kl": 0.03193492229828072, "entropy": 0.27105835231561815, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 733.0, "episode_reward_min": -30.0, "episode_reward_mean": 240.4, "episode_len_mean": 750.0666666666667, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0, 419.0, 693.0, 683.0, 733.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3354301439941688, "mean_inference_ms": 1.0904243920818497, "mean_action_processing_ms": 0.11632913044439187, "mean_env_wait_ms": 0.6236919177626653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0006532669067382812, "ObsPreprocessorConnector_ms": 0.006664594014485677, "MeanStdObservationFilterAgentConnector_ms": 0.03452777862548828, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.10121504465738933}}, "episode_reward_max": 733.0, "episode_reward_min": -30.0, "episode_reward_mean": 240.4, "episode_len_mean": 750.0666666666667, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0, 419.0, 693.0, 683.0, 733.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3354301439941688, "mean_inference_ms": 1.0904243920818497, "mean_action_processing_ms": 0.11632913044439187, "mean_env_wait_ms": 0.6236919177626653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0006532669067382812, "ObsPreprocessorConnector_ms": 0.006664594014485677, "MeanStdObservationFilterAgentConnector_ms": 0.03452777862548828, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.10121504465738933}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 13804.69, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 5185.145, "learn_throughput": 771.435, "synch_weights_time_ms": 1.955}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 15, "training_iteration": 3, "trial_id": "bfbe5_00000", "experiment_id": "9d397f7cc24449e6a0a9d132139c82a3", "date": "2023-03-20_16-11-57", "timestamp": 1679299917, "time_this_iter_s": 13.458635568618774, "time_total_s": 41.4502854347229, "pid": 20684, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002BA012DE4C0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x000002B8CDB45AF0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 41.4502854347229, "timesteps_since_restore": 0, "iterations_since_restore": 3, "warmup_time": 6.740259885787964, "perf": {"cpu_util_percent": 22.88421052631579, "ram_util_percent": 58.626315789473686}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7585990207329874, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 9.800000000000001e-05, "total_loss": 0.0728277722406151, "policy_loss": -0.08725516902062522, "vf_loss": 0.31130300219501217, "vf_explained_var": 0.027806949871842578, "kl": 0.009535490156683193, "entropy": 0.20050154996495093, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 835.0, "episode_reward_min": -30.0, "episode_reward_mean": 360.42105263157896, "episode_len_mean": 802.6842105263158, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0, 419.0, 693.0, 683.0, 733.0, 767.0, 825.0, 835.0, 815.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3353314611490689, "mean_inference_ms": 1.088128932291946, "mean_action_processing_ms": 0.1162763845276923, "mean_env_wait_ms": 0.609380074259257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0005157370316354852, "ObsPreprocessorConnector_ms": 0.0052615215903834296, "MeanStdObservationFilterAgentConnector_ms": 0.03296952498586554, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.10144961507696855}}, "episode_reward_max": 835.0, "episode_reward_min": -30.0, "episode_reward_mean": 360.42105263157896, "episode_len_mean": 802.6842105263158, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0, 419.0, 693.0, 683.0, 733.0, 767.0, 825.0, 835.0, 815.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3353314611490689, "mean_inference_ms": 1.088128932291946, "mean_action_processing_ms": 0.1162763845276923, "mean_env_wait_ms": 0.609380074259257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0005157370316354852, "ObsPreprocessorConnector_ms": 0.0052615215903834296, "MeanStdObservationFilterAgentConnector_ms": 0.03296952498586554, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.10144961507696855}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 13631.368, "load_time_ms": 0.243, "load_throughput": 16440192.063, "learn_time_ms": 5206.338, "learn_throughput": 768.294, "synch_weights_time_ms": 1.73}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 19, "training_iteration": 4, "trial_id": "bfbe5_00000", "experiment_id": "9d397f7cc24449e6a0a9d132139c82a3", "date": "2023-03-20_16-12-10", "timestamp": 1679299930, "time_this_iter_s": 13.12259316444397, "time_total_s": 54.57287859916687, "pid": 20684, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002BA012DEF10>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x000002BA012135E0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 54.57287859916687, "timesteps_since_restore": 0, "iterations_since_restore": 4, "warmup_time": 6.740259885787964, "perf": {"cpu_util_percent": 22.755555555555553, "ram_util_percent": 58.70000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.602600791673827, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 9.4e-05, "total_loss": 0.03279343583816362, "policy_loss": -0.06759501342030783, "vf_loss": 0.19639956415180237, "vf_explained_var": 0.021219755821330573, "kl": 0.005388235464400756, "entropy": 0.14483921004719633, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 905.0, "episode_reward_min": -30.0, "episode_reward_mean": 450.4347826086956, "episode_len_mean": 837.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0, 419.0, 693.0, 683.0, 733.0, 767.0, 825.0, 835.0, 815.0, 839.0, 889.0, 879.0, 905.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3350682181997468, "mean_inference_ms": 1.0867282089869932, "mean_action_processing_ms": 0.11623984447167122, "mean_env_wait_ms": 0.5948682369231294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.00042604363482931387, "ObsPreprocessorConnector_ms": 0.004346474357273268, "MeanStdObservationFilterAgentConnector_ms": 0.03157491269318954, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09251781131910242}}, "episode_reward_max": 905.0, "episode_reward_min": -30.0, "episode_reward_mean": 450.4347826086956, "episode_len_mean": 837.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0, 419.0, 693.0, 683.0, 733.0, 767.0, 825.0, 835.0, 815.0, 839.0, 889.0, 879.0, 905.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3350682181997468, "mean_inference_ms": 1.0867282089869932, "mean_action_processing_ms": 0.11623984447167122, "mean_env_wait_ms": 0.5948682369231294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.00042604363482931387, "ObsPreprocessorConnector_ms": 0.004346474357273268, "MeanStdObservationFilterAgentConnector_ms": 0.03157491269318954, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09251781131910242}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 13539.06, "load_time_ms": 0.195, "load_throughput": 20550240.078, "learn_time_ms": 5235.492, "learn_throughput": 764.016, "synch_weights_time_ms": 1.784}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 23, "training_iteration": 5, "trial_id": "bfbe5_00000", "experiment_id": "9d397f7cc24449e6a0a9d132139c82a3", "date": "2023-03-20_16-12-23", "timestamp": 1679299943, "time_this_iter_s": 13.182031393051147, "time_total_s": 67.75490999221802, "pid": 20684, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002BA012DE520>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x000002BA010FA940>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 67.75490999221802, "timesteps_since_restore": 0, "iterations_since_restore": 5, "warmup_time": 6.740259885787964, "perf": {"cpu_util_percent": 22.52631578947368, "ram_util_percent": 58.70000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6527849451668801, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 9e-05, "total_loss": 0.016343575303933475, "policy_loss": -0.051619142737560055, "vf_loss": 0.13302056848519653, "vf_explained_var": -0.037401805898194675, "kl": 0.003702956474777768, "entropy": 0.10470615232823997, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 927.0, "episode_reward_min": -30.0, "episode_reward_mean": 520.4444444444445, "episode_len_mean": 861.1481481481482, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0, 419.0, 693.0, 683.0, 733.0, 767.0, 825.0, 835.0, 815.0, 839.0, 889.0, 879.0, 905.0, 915.0, 923.0, 927.0, 927.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3349499886934945, "mean_inference_ms": 1.0858019863351924, "mean_action_processing_ms": 0.1163078433026742, "mean_env_wait_ms": 0.5812579311020643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0003629260592990451, "ObsPreprocessorConnector_ms": 0.0037025522302698206, "MeanStdObservationFilterAgentConnector_ms": 0.034508881745515044, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09381682784469039}}, "episode_reward_max": 927.0, "episode_reward_min": -30.0, "episode_reward_mean": 520.4444444444445, "episode_len_mean": 861.1481481481482, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0, 419.0, 693.0, 683.0, 733.0, 767.0, 825.0, 835.0, 815.0, 839.0, 889.0, 879.0, 905.0, 915.0, 923.0, 927.0, 927.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3349499886934945, "mean_inference_ms": 1.0858019863351924, "mean_action_processing_ms": 0.1163078433026742, "mean_env_wait_ms": 0.5812579311020643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0003629260592990451, "ObsPreprocessorConnector_ms": 0.0037025522302698206, "MeanStdObservationFilterAgentConnector_ms": 0.034508881745515044, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09381682784469039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 13478.044, "load_time_ms": 0.162, "load_throughput": 24660288.094, "learn_time_ms": 5257.965, "learn_throughput": 760.751, "synch_weights_time_ms": 1.814}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 27, "training_iteration": 6, "trial_id": "bfbe5_00000", "experiment_id": "9d397f7cc24449e6a0a9d132139c82a3", "date": "2023-03-20_16-12-36", "timestamp": 1679299956, "time_this_iter_s": 13.186097383499146, "time_total_s": 80.94100737571716, "pid": 20684, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002BA012DE790>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x000002B8CDB451F0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 80.94100737571716, "timesteps_since_restore": 0, "iterations_since_restore": 6, "warmup_time": 6.740259885787964, "perf": {"cpu_util_percent": 24.215789473684207, "ram_util_percent": 58.694736842105264}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6367212276945832, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 8.599999999999999e-05, "total_loss": 0.005196738586715994, "policy_loss": -0.046702798997722964, "vf_loss": 0.1020726819482622, "vf_explained_var": -0.016262713170820668, "kl": 0.004587944231360473, "entropy": 0.06852350979242273, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 959.0, "episode_reward_min": -30.0, "episode_reward_mean": 575.2258064516129, "episode_len_mean": 879.0645161290323, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0, 419.0, 693.0, 683.0, 733.0, 767.0, 825.0, 835.0, 815.0, 839.0, 889.0, 879.0, 905.0, 915.0, 923.0, 927.0, 927.0, 943.0, 959.0, 949.0, 929.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3348003308420873, "mean_inference_ms": 1.0851595982286342, "mean_action_processing_ms": 0.11635597412247423, "mean_env_wait_ms": 0.5691595629788597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.00031609689035723285, "ObsPreprocessorConnector_ms": 0.0032248035553962954, "MeanStdObservationFilterAgentConnector_ms": 0.03692642334968813, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09496673460929625}}, "episode_reward_max": 959.0, "episode_reward_min": -30.0, "episode_reward_mean": 575.2258064516129, "episode_len_mean": 879.0645161290323, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0, 419.0, 693.0, 683.0, 733.0, 767.0, 825.0, 835.0, 815.0, 839.0, 889.0, 879.0, 905.0, 915.0, 923.0, 927.0, 927.0, 943.0, 959.0, 949.0, 929.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3348003308420873, "mean_inference_ms": 1.0851595982286342, "mean_action_processing_ms": 0.11635597412247423, "mean_env_wait_ms": 0.5691595629788597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.00031609689035723285, "ObsPreprocessorConnector_ms": 0.0032248035553962954, "MeanStdObservationFilterAgentConnector_ms": 0.03692642334968813, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09496673460929625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 13398.337, "load_time_ms": 0.282, "load_throughput": 14192206.888, "learn_time_ms": 5240.417, "learn_throughput": 763.298, "synch_weights_time_ms": 1.856}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 31, "training_iteration": 7, "trial_id": "bfbe5_00000", "experiment_id": "9d397f7cc24449e6a0a9d132139c82a3", "date": "2023-03-20_16-12-49", "timestamp": 1679299969, "time_this_iter_s": 12.931333780288696, "time_total_s": 93.87234115600586, "pid": 20684, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002BA012EA490>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x000002B8CDB45820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 93.87234115600586, "timesteps_since_restore": 0, "iterations_since_restore": 7, "warmup_time": 6.740259885787964, "perf": {"cpu_util_percent": 22.794444444444444, "ram_util_percent": 58.67777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6284104234348702, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 8.200000000000003e-05, "total_loss": -0.0024198402860952963, "policy_loss": -0.03132365828064541, "vf_loss": 0.0572236214985355, "vf_explained_var": -0.05998609226237061, "kl": 0.004254464995058975, "entropy": 0.042593384688339564, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 969.0, "episode_reward_min": -30.0, "episode_reward_mean": 619.4285714285714, "episode_len_mean": 892.8857142857142, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0, 419.0, 693.0, 683.0, 733.0, 767.0, 825.0, 835.0, 815.0, 839.0, 889.0, 879.0, 905.0, 915.0, 923.0, 927.0, 927.0, 943.0, 959.0, 949.0, 929.0, 947.0, 965.0, 969.0, 967.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33468041175267615, "mean_inference_ms": 1.0847224992833548, "mean_action_processing_ms": 0.11648134472764135, "mean_env_wait_ms": 0.5585771778599155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0002799715314592634, "ObsPreprocessorConnector_ms": 0.005788121904645648, "MeanStdObservationFilterAgentConnector_ms": 0.03288813999720982, "StateBufferConnector_ms": 0.0027799606323242188, "ViewRequirementAgentConnector_ms": 0.0957284654889788}}, "episode_reward_max": 969.0, "episode_reward_min": -30.0, "episode_reward_mean": 619.4285714285714, "episode_len_mean": 892.8857142857142, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0, 419.0, 693.0, 683.0, 733.0, 767.0, 825.0, 835.0, 815.0, 839.0, 889.0, 879.0, 905.0, 915.0, 923.0, 927.0, 927.0, 943.0, 959.0, 949.0, 929.0, 947.0, 965.0, 969.0, 967.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33468041175267615, "mean_inference_ms": 1.0847224992833548, "mean_action_processing_ms": 0.11648134472764135, "mean_env_wait_ms": 0.5585771778599155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0002799715314592634, "ObsPreprocessorConnector_ms": 0.005788121904645648, "MeanStdObservationFilterAgentConnector_ms": 0.03288813999720982, "StateBufferConnector_ms": 0.0027799606323242188, "ViewRequirementAgentConnector_ms": 0.0957284654889788}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 13353.492, "load_time_ms": 0.372, "load_throughput": 10764113.241, "learn_time_ms": 5235.023, "learn_throughput": 764.085, "synch_weights_time_ms": 1.878}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 35, "training_iteration": 8, "trial_id": "bfbe5_00000", "experiment_id": "9d397f7cc24449e6a0a9d132139c82a3", "date": "2023-03-20_16-13-02", "timestamp": 1679299982, "time_this_iter_s": 13.051934957504272, "time_total_s": 106.92427611351013, "pid": 20684, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002BA012DEE50>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x000002BA01250AF0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 106.92427611351013, "timesteps_since_restore": 0, "iterations_since_restore": 8, "warmup_time": 6.740259885787964, "perf": {"cpu_util_percent": 23.538888888888888, "ram_util_percent": 58.70000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8007060644587362, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 7.799999999999997e-05, "total_loss": 0.0016890916755543121, "policy_loss": -0.018725109059533847, "vf_loss": 0.0400722730517275, "vf_explained_var": -0.14496565281703908, "kl": 0.006551805606928029, "entropy": 0.017474388638611442, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 983.0, "episode_reward_min": -30.0, "episode_reward_mean": 655.8974358974359, "episode_len_mean": 903.8717948717949, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0, 419.0, 693.0, 683.0, 733.0, 767.0, 825.0, 835.0, 815.0, 839.0, 889.0, 879.0, 905.0, 915.0, 923.0, 927.0, 927.0, 943.0, 959.0, 949.0, 929.0, 947.0, 965.0, 969.0, 967.0, 975.0, 983.0, 973.0, 969.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3354809326857537, "mean_inference_ms": 1.087468540635175, "mean_action_processing_ms": 0.11684529675711393, "mean_env_wait_ms": 0.5500296449371558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0002512565025916466, "ObsPreprocessorConnector_ms": 0.005194468375964043, "MeanStdObservationFilterAgentConnector_ms": 0.03977005298321064, "StateBufferConnector_ms": 0.0024948364649063502, "ViewRequirementAgentConnector_ms": 0.09899628468048878}}, "episode_reward_max": 983.0, "episode_reward_min": -30.0, "episode_reward_mean": 655.8974358974359, "episode_len_mean": 903.8717948717949, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0, 419.0, 693.0, 683.0, 733.0, 767.0, 825.0, 835.0, 815.0, 839.0, 889.0, 879.0, 905.0, 915.0, 923.0, 927.0, 927.0, 943.0, 959.0, 949.0, 929.0, 947.0, 965.0, 969.0, 967.0, 975.0, 983.0, 973.0, 969.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3354809326857537, "mean_inference_ms": 1.087468540635175, "mean_action_processing_ms": 0.11684529675711393, "mean_env_wait_ms": 0.5500296449371558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0002512565025916466, "ObsPreprocessorConnector_ms": 0.005194468375964043, "MeanStdObservationFilterAgentConnector_ms": 0.03977005298321064, "StateBufferConnector_ms": 0.0024948364649063502, "ViewRequirementAgentConnector_ms": 0.09899628468048878}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 13517.541, "load_time_ms": 0.441, "load_throughput": 9060602.7, "learn_time_ms": 5237.29, "learn_throughput": 763.754, "synch_weights_time_ms": 1.906}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 39, "training_iteration": 9, "trial_id": "bfbe5_00000", "experiment_id": "9d397f7cc24449e6a0a9d132139c82a3", "date": "2023-03-20_16-13-17", "timestamp": 1679299997, "time_this_iter_s": 14.841067790985107, "time_total_s": 121.76534390449524, "pid": 20684, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002BA012F8BE0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x000002BA011F29D0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 121.76534390449524, "timesteps_since_restore": 0, "iterations_since_restore": 9, "warmup_time": 6.740259885787964, "perf": {"cpu_util_percent": 43.099999999999994, "ram_util_percent": 58.71428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.13795328832191406, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 7.400000000000004e-05, "total_loss": -0.012247115208846216, "policy_loss": -0.01623492714353106, "vf_loss": 0.007931577629989734, "vf_explained_var": -0.4707660787208106, "kl": 0.0013391128593434477, "entropy": 0.009096461214545755, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 997.0, "episode_reward_min": -30.0, "episode_reward_mean": 687.3023255813954, "episode_len_mean": 912.8139534883721, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0, 419.0, 693.0, 683.0, 733.0, 767.0, 825.0, 835.0, 815.0, 839.0, 889.0, 879.0, 905.0, 915.0, 923.0, 927.0, 927.0, 943.0, 959.0, 949.0, 929.0, 947.0, 965.0, 969.0, 967.0, 975.0, 983.0, 973.0, 969.0, 991.0, 993.0, 997.0, 993.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33623904499053475, "mean_inference_ms": 1.0900869182167714, "mean_action_processing_ms": 0.11709088675592029, "mean_env_wait_ms": 0.5422614307294226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.00022788380467614463, "ObsPreprocessorConnector_ms": 0.004711262015409248, "MeanStdObservationFilterAgentConnector_ms": 0.0383986983188363, "StateBufferConnector_ms": 0.0022627586542173874, "ViewRequirementAgentConnector_ms": 0.1070416250894236}}, "episode_reward_max": 997.0, "episode_reward_min": -30.0, "episode_reward_mean": 687.3023255813954, "episode_len_mean": 912.8139534883721, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0, 419.0, 693.0, 683.0, 733.0, 767.0, 825.0, 835.0, 815.0, 839.0, 889.0, 879.0, 905.0, 915.0, 923.0, 927.0, 927.0, 943.0, 959.0, 949.0, 929.0, 947.0, 965.0, 969.0, 967.0, 975.0, 983.0, 973.0, 969.0, 991.0, 993.0, 997.0, 993.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33623904499053475, "mean_inference_ms": 1.0900869182167714, "mean_action_processing_ms": 0.11709088675592029, "mean_env_wait_ms": 0.5422614307294226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.00022788380467614463, "ObsPreprocessorConnector_ms": 0.004711262015409248, "MeanStdObservationFilterAgentConnector_ms": 0.0383986983188363, "StateBufferConnector_ms": 0.0022627586542173874, "ViewRequirementAgentConnector_ms": 0.1070416250894236}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 13522.459, "load_time_ms": 0.397, "load_throughput": 10067336.334, "learn_time_ms": 5258.963, "learn_throughput": 760.606, "synch_weights_time_ms": 1.815}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 43, "training_iteration": 10, "trial_id": "bfbe5_00000", "experiment_id": "9d397f7cc24449e6a0a9d132139c82a3", "date": "2023-03-20_16-13-31", "timestamp": 1679300011, "time_this_iter_s": 13.577949047088623, "time_total_s": 135.34329295158386, "pid": 20684, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002BA012F8850>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x000002BA010FA940>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 135.34329295158386, "timesteps_since_restore": 0, "iterations_since_restore": 10, "warmup_time": 6.740259885787964, "perf": {"cpu_util_percent": 31.08421052631579, "ram_util_percent": 58.70000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1724035670082036, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 7e-05, "total_loss": 0.14880830587879304, "policy_loss": 0.14087232919860512, "vf_loss": 0.01399627645702225, "vf_explained_var": -0.3347122819833858, "kl": 0.023351997054069665, "entropy": 0.004732768438000392, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 997.0, "episode_reward_min": -30.0, "episode_reward_mean": 713.2340425531914, "episode_len_mean": 920.2340425531914, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0, 419.0, 693.0, 683.0, 733.0, 767.0, 825.0, 835.0, 815.0, 839.0, 889.0, 879.0, 905.0, 915.0, 923.0, 927.0, 927.0, 943.0, 959.0, 949.0, 929.0, 947.0, 965.0, 969.0, 967.0, 975.0, 983.0, 973.0, 969.0, 991.0, 993.0, 997.0, 993.0, 993.0, 991.0, 991.0, 993.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.336883718682903, "mean_inference_ms": 1.0919409560535043, "mean_action_processing_ms": 0.117294706397109, "mean_env_wait_ms": 0.534910294294637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0023344729809050865, "ObsPreprocessorConnector_ms": 0.0043103035460127165, "MeanStdObservationFilterAgentConnector_ms": 0.039909241047311333, "StateBufferConnector_ms": 0.002070183449603142, "ViewRequirementAgentConnector_ms": 0.11277300246218418}}, "episode_reward_max": 997.0, "episode_reward_min": -30.0, "episode_reward_mean": 713.2340425531914, "episode_len_mean": 920.2340425531914, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0, 419.0, 693.0, 683.0, 733.0, 767.0, 825.0, 835.0, 815.0, 839.0, 889.0, 879.0, 905.0, 915.0, 923.0, 927.0, 927.0, 943.0, 959.0, 949.0, 929.0, 947.0, 965.0, 969.0, 967.0, 975.0, 983.0, 973.0, 969.0, 991.0, 993.0, 997.0, 993.0, 993.0, 991.0, 991.0, 993.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.336883718682903, "mean_inference_ms": 1.0919409560535043, "mean_action_processing_ms": 0.117294706397109, "mean_env_wait_ms": 0.534910294294637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0023344729809050865, "ObsPreprocessorConnector_ms": 0.0043103035460127165, "MeanStdObservationFilterAgentConnector_ms": 0.039909241047311333, "StateBufferConnector_ms": 0.002070183449603142, "ViewRequirementAgentConnector_ms": 0.11277300246218418}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 13406.457, "load_time_ms": 0.397, "load_throughput": 10067336.334, "learn_time_ms": 5258.844, "learn_throughput": 760.623, "synch_weights_time_ms": 1.823}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 47, "training_iteration": 11, "trial_id": "bfbe5_00000", "experiment_id": "9d397f7cc24449e6a0a9d132139c82a3", "date": "2023-03-20_16-13-44", "timestamp": 1679300024, "time_this_iter_s": 12.780046701431274, "time_total_s": 148.12333965301514, "pid": 20684, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002BA013012B0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x000002BA01213670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 148.12333965301514, "timesteps_since_restore": 0, "iterations_since_restore": 11, "warmup_time": 6.740259885787964, "perf": {"cpu_util_percent": 23.633333333333333, "ram_util_percent": 58.70000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2532824176058213, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 6.599999999999998e-05, "total_loss": -0.009830644984259545, "policy_loss": -0.02523066698403288, "vf_loss": 0.026925169879896495, "vf_explained_var": 0.1268476180491909, "kl": 0.031268829799206886, "entropy": 0.004129341997266296, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 997.0, "episode_reward_min": -30.0, "episode_reward_mean": 734.1176470588235, "episode_len_mean": 926.4901960784314, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0, 419.0, 693.0, 683.0, 733.0, 767.0, 825.0, 835.0, 815.0, 839.0, 889.0, 879.0, 905.0, 915.0, 923.0, 927.0, 927.0, 943.0, 959.0, 949.0, 929.0, 947.0, 965.0, 969.0, 967.0, 975.0, 983.0, 973.0, 969.0, 991.0, 993.0, 997.0, 993.0, 993.0, 991.0, 991.0, 993.0, 989.0, 979.0, 973.0, 977.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3372964636880821, "mean_inference_ms": 1.0930545769668762, "mean_action_processing_ms": 0.11743344229004596, "mean_env_wait_ms": 0.5279528248385996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.004112486745796951, "ObsPreprocessorConnector_ms": 0.003972240522796032, "MeanStdObservationFilterAgentConnector_ms": 0.04258109074012906, "StateBufferConnector_ms": 0.001907816120222503, "ViewRequirementAgentConnector_ms": 0.10784280066396676}}, "episode_reward_max": 997.0, "episode_reward_min": -30.0, "episode_reward_mean": 734.1176470588235, "episode_len_mean": 926.4901960784314, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0, 419.0, 693.0, 683.0, 733.0, 767.0, 825.0, 835.0, 815.0, 839.0, 889.0, 879.0, 905.0, 915.0, 923.0, 927.0, 927.0, 943.0, 959.0, 949.0, 929.0, 947.0, 965.0, 969.0, 967.0, 975.0, 983.0, 973.0, 969.0, 991.0, 993.0, 997.0, 993.0, 993.0, 991.0, 991.0, 993.0, 989.0, 979.0, 973.0, 977.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3372964636880821, "mean_inference_ms": 1.0930545769668762, "mean_action_processing_ms": 0.11743344229004596, "mean_env_wait_ms": 0.5279528248385996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.004112486745796951, "ObsPreprocessorConnector_ms": 0.003972240522796032, "MeanStdObservationFilterAgentConnector_ms": 0.04258109074012906, "StateBufferConnector_ms": 0.001907816120222503, "ViewRequirementAgentConnector_ms": 0.10784280066396676}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 13267.202, "load_time_ms": 0.497, "load_throughput": 8045082.958, "learn_time_ms": 5257.799, "learn_throughput": 760.775, "synch_weights_time_ms": 1.723}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 51, "training_iteration": 12, "trial_id": "bfbe5_00000", "experiment_id": "9d397f7cc24449e6a0a9d132139c82a3", "date": "2023-03-20_16-13-56", "timestamp": 1679300036, "time_this_iter_s": 12.657444953918457, "time_total_s": 160.7807846069336, "pid": 20684, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002BA01301610>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x000002BA01250AF0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 160.7807846069336, "timesteps_since_restore": 0, "iterations_since_restore": 12, "warmup_time": 6.740259885787964, "perf": {"cpu_util_percent": 21.405555555555555, "ram_util_percent": 58.70000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9639088976953019, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 6.2e-05, "total_loss": 0.002712100659783739, "policy_loss": -0.000945972563118063, "vf_loss": 0.006928016120488097, "vf_explained_var": -0.6145207393553949, "kl": 0.0023975489022530316, "entropy": 0.003351572089044938, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 999.0, "episode_reward_min": -30.0, "episode_reward_mean": 752.9818181818182, "episode_len_mean": 931.8363636363637, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0, 419.0, 693.0, 683.0, 733.0, 767.0, 825.0, 835.0, 815.0, 839.0, 889.0, 879.0, 905.0, 915.0, 923.0, 927.0, 927.0, 943.0, 959.0, 949.0, 929.0, 947.0, 965.0, 969.0, 967.0, 975.0, 983.0, 973.0, 969.0, 991.0, 993.0, 997.0, 993.0, 993.0, 991.0, 991.0, 993.0, 989.0, 979.0, 973.0, 977.0, 981.0, 995.0, 999.0, 999.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3375271214317793, "mean_inference_ms": 1.093566312034674, "mean_action_processing_ms": 0.11753807085441734, "mean_env_wait_ms": 0.521366677616239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0038133968006480823, "ObsPreprocessorConnector_ms": 0.0036833503029563212, "MeanStdObservationFilterAgentConnector_ms": 0.04156546159224077, "StateBufferConnector_ms": 0.0017690658569335938, "ViewRequirementAgentConnector_ms": 0.10191613977605646}}, "episode_reward_max": 999.0, "episode_reward_min": -30.0, "episode_reward_mean": 752.9818181818182, "episode_len_mean": 931.8363636363637, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0, 419.0, 693.0, 683.0, 733.0, 767.0, 825.0, 835.0, 815.0, 839.0, 889.0, 879.0, 905.0, 915.0, 923.0, 927.0, 927.0, 943.0, 959.0, 949.0, 929.0, 947.0, 965.0, 969.0, 967.0, 975.0, 983.0, 973.0, 969.0, 991.0, 993.0, 997.0, 993.0, 993.0, 991.0, 991.0, 993.0, 989.0, 979.0, 973.0, 977.0, 981.0, 995.0, 999.0, 999.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3375271214317793, "mean_inference_ms": 1.093566312034674, "mean_action_processing_ms": 0.11753807085441734, "mean_env_wait_ms": 0.521366677616239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0038133968006480823, "ObsPreprocessorConnector_ms": 0.0036833503029563212, "MeanStdObservationFilterAgentConnector_ms": 0.04156546159224077, "StateBufferConnector_ms": 0.0017690658569335938, "ViewRequirementAgentConnector_ms": 0.10191613977605646}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 13161.34, "load_time_ms": 0.595, "load_throughput": 6725413.293, "learn_time_ms": 5254.723, "learn_throughput": 761.22, "synch_weights_time_ms": 1.723}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 55, "training_iteration": 13, "trial_id": "bfbe5_00000", "experiment_id": "9d397f7cc24449e6a0a9d132139c82a3", "date": "2023-03-20_16-14-09", "timestamp": 1679300049, "time_this_iter_s": 12.401179552078247, "time_total_s": 173.18196415901184, "pid": 20684, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002BA012F8850>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x000002BA011F29D0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 173.18196415901184, "timesteps_since_restore": 0, "iterations_since_restore": 13, "warmup_time": 6.740259885787964, "perf": {"cpu_util_percent": 20.052941176470586, "ram_util_percent": 58.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9788495785974828, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 5.8e-05, "total_loss": 0.04159686164675413, "policy_loss": 0.0381457058685301, "vf_loss": 0.005471964389351596, "vf_explained_var": -0.5161660647520455, "kl": 0.015675225160052892, "entropy": 0.002878846273969068, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 999.0, "episode_reward_min": -30.0, "episode_reward_mean": 769.457627118644, "episode_len_mean": 936.457627118644, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0, 419.0, 693.0, 683.0, 733.0, 767.0, 825.0, 835.0, 815.0, 839.0, 889.0, 879.0, 905.0, 915.0, 923.0, 927.0, 927.0, 943.0, 959.0, 949.0, 929.0, 947.0, 965.0, 969.0, 967.0, 975.0, 983.0, 973.0, 969.0, 991.0, 993.0, 997.0, 993.0, 993.0, 991.0, 991.0, 993.0, 989.0, 979.0, 973.0, 977.0, 981.0, 995.0, 999.0, 999.0, 997.0, 997.0, 993.0, 997.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33761968287664906, "mean_inference_ms": 1.0937460501868332, "mean_action_processing_ms": 0.11758286924268858, "mean_env_wait_ms": 0.5152207524452004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.003554861424332958, "ObsPreprocessorConnector_ms": 0.0034336316383491126, "MeanStdObservationFilterAgentConnector_ms": 0.04223362874176543, "StateBufferConnector_ms": 0.0016491291886669094, "ViewRequirementAgentConnector_ms": 0.10200435832395392}}, "episode_reward_max": 999.0, "episode_reward_min": -30.0, "episode_reward_mean": 769.457627118644, "episode_len_mean": 936.457627118644, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0, 419.0, 693.0, 683.0, 733.0, 767.0, 825.0, 835.0, 815.0, 839.0, 889.0, 879.0, 905.0, 915.0, 923.0, 927.0, 927.0, 943.0, 959.0, 949.0, 929.0, 947.0, 965.0, 969.0, 967.0, 975.0, 983.0, 973.0, 969.0, 991.0, 993.0, 997.0, 993.0, 993.0, 991.0, 991.0, 993.0, 989.0, 979.0, 973.0, 977.0, 981.0, 995.0, 999.0, 999.0, 997.0, 997.0, 993.0, 997.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33761968287664906, "mean_inference_ms": 1.0937460501868332, "mean_action_processing_ms": 0.11758286924268858, "mean_env_wait_ms": 0.5152207524452004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.003554861424332958, "ObsPreprocessorConnector_ms": 0.0034336316383491126, "MeanStdObservationFilterAgentConnector_ms": 0.04223362874176543, "StateBufferConnector_ms": 0.0016491291886669094, "ViewRequirementAgentConnector_ms": 0.10200435832395392}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 13094.329, "load_time_ms": 0.607, "load_throughput": 6584723.105, "learn_time_ms": 5236.311, "learn_throughput": 763.897, "synch_weights_time_ms": 2.033}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 59, "training_iteration": 14, "trial_id": "bfbe5_00000", "experiment_id": "9d397f7cc24449e6a0a9d132139c82a3", "date": "2023-03-20_16-14-21", "timestamp": 1679300061, "time_this_iter_s": 12.452605485916138, "time_total_s": 185.63456964492798, "pid": 20684, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002BA012EADC0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x000002BA010FA940>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 185.63456964492798, "timesteps_since_restore": 0, "iterations_since_restore": 14, "warmup_time": 6.740259885787964, "perf": {"cpu_util_percent": 23.277777777777782, "ram_util_percent": 58.36666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8861914733280828, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 5.4e-05, "total_loss": -0.002301474496511297, "policy_loss": -0.004360623627535558, "vf_loss": 0.003976426403654333, "vf_explained_var": -0.5998829250053693, "kl": 0.002056108215203529, "entropy": 0.0026649536184092824, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 999.0, "episode_reward_min": -30.0, "episode_reward_mean": 783.9047619047619, "episode_len_mean": 940.4920634920635, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0, 419.0, 693.0, 683.0, 733.0, 767.0, 825.0, 835.0, 815.0, 839.0, 889.0, 879.0, 905.0, 915.0, 923.0, 927.0, 927.0, 943.0, 959.0, 949.0, 929.0, 947.0, 965.0, 969.0, 967.0, 975.0, 983.0, 973.0, 969.0, 991.0, 993.0, 997.0, 993.0, 993.0, 991.0, 991.0, 993.0, 989.0, 979.0, 973.0, 977.0, 981.0, 995.0, 999.0, 999.0, 997.0, 997.0, 993.0, 997.0, 997.0, 997.0, 997.0, 997.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3376277462701077, "mean_inference_ms": 1.0937320575200027, "mean_action_processing_ms": 0.1176124709751841, "mean_env_wait_ms": 0.5095075390474185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0033291559370737227, "ObsPreprocessorConnector_ms": 0.0032156232803586928, "MeanStdObservationFilterAgentConnector_ms": 0.04113969348725818, "StateBufferConnector_ms": 0.0015444225735134548, "ViewRequirementAgentConnector_ms": 0.10038935948931982}}, "episode_reward_max": 999.0, "episode_reward_min": -30.0, "episode_reward_mean": 783.9047619047619, "episode_len_mean": 940.4920634920635, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0, 419.0, 693.0, 683.0, 733.0, 767.0, 825.0, 835.0, 815.0, 839.0, 889.0, 879.0, 905.0, 915.0, 923.0, 927.0, 927.0, 943.0, 959.0, 949.0, 929.0, 947.0, 965.0, 969.0, 967.0, 975.0, 983.0, 973.0, 969.0, 991.0, 993.0, 997.0, 993.0, 993.0, 991.0, 991.0, 993.0, 989.0, 979.0, 973.0, 977.0, 981.0, 995.0, 999.0, 999.0, 997.0, 997.0, 993.0, 997.0, 997.0, 997.0, 997.0, 997.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3376277462701077, "mean_inference_ms": 1.0937320575200027, "mean_action_processing_ms": 0.1176124709751841, "mean_env_wait_ms": 0.5095075390474185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0033291559370737227, "ObsPreprocessorConnector_ms": 0.0032156232803586928, "MeanStdObservationFilterAgentConnector_ms": 0.04113969348725818, "StateBufferConnector_ms": 0.0015444225735134548, "ViewRequirementAgentConnector_ms": 0.10038935948931982}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 13054.988, "load_time_ms": 0.607, "load_throughput": 6584723.105, "learn_time_ms": 5233.294, "learn_throughput": 764.337, "synch_weights_time_ms": 2.334}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 63, "training_iteration": 15, "trial_id": "bfbe5_00000", "experiment_id": "9d397f7cc24449e6a0a9d132139c82a3", "date": "2023-03-20_16-14-34", "timestamp": 1679300074, "time_this_iter_s": 12.825412273406982, "time_total_s": 198.45998191833496, "pid": 20684, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002BA012E71C0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x000002B8CDB45820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 198.45998191833496, "timesteps_since_restore": 0, "iterations_since_restore": 15, "warmup_time": 6.740259885787964, "perf": {"cpu_util_percent": 24.150000000000002, "ram_util_percent": 57.79999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5339496895866168, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0020765831866126345, "policy_loss": 0.00048529967623111864, "vf_loss": 0.0031007710697473177, "vf_explained_var": -0.6751616231856807, "kl": 0.0027285538559620455, "entropy": 0.0023852682059695846, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 999.0, "episode_reward_min": -30.0, "episode_reward_mean": 796.6268656716418, "episode_len_mean": 944.044776119403, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0, 419.0, 693.0, 683.0, 733.0, 767.0, 825.0, 835.0, 815.0, 839.0, 889.0, 879.0, 905.0, 915.0, 923.0, 927.0, 927.0, 943.0, 959.0, 949.0, 929.0, 947.0, 965.0, 969.0, 967.0, 975.0, 983.0, 973.0, 969.0, 991.0, 993.0, 997.0, 993.0, 993.0, 991.0, 991.0, 993.0, 989.0, 979.0, 973.0, 977.0, 981.0, 995.0, 999.0, 999.0, 997.0, 997.0, 993.0, 997.0, 997.0, 997.0, 997.0, 997.0, 997.0, 999.0, 999.0, 993.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3377790355867092, "mean_inference_ms": 1.0946077401444942, "mean_action_processing_ms": 0.11771963431977797, "mean_env_wait_ms": 0.5044202349760109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0031304003587409633, "ObsPreprocessorConnector_ms": 0.003023645771083547, "MeanStdObservationFilterAgentConnector_ms": 0.04467786248050519, "StateBufferConnector_ms": 0.0014522182407663829, "ViewRequirementAgentConnector_ms": 0.0989878355567135}}, "episode_reward_max": 999.0, "episode_reward_min": -30.0, "episode_reward_mean": 796.6268656716418, "episode_len_mean": 944.044776119403, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0, 419.0, 693.0, 683.0, 733.0, 767.0, 825.0, 835.0, 815.0, 839.0, 889.0, 879.0, 905.0, 915.0, 923.0, 927.0, 927.0, 943.0, 959.0, 949.0, 929.0, 947.0, 965.0, 969.0, 967.0, 975.0, 983.0, 973.0, 969.0, 991.0, 993.0, 997.0, 993.0, 993.0, 991.0, 991.0, 993.0, 989.0, 979.0, 973.0, 977.0, 981.0, 995.0, 999.0, 999.0, 997.0, 997.0, 993.0, 997.0, 997.0, 997.0, 997.0, 997.0, 997.0, 999.0, 999.0, 993.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3377790355867092, "mean_inference_ms": 1.0946077401444942, "mean_action_processing_ms": 0.11771963431977797, "mean_env_wait_ms": 0.5044202349760109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0031304003587409633, "ObsPreprocessorConnector_ms": 0.003023645771083547, "MeanStdObservationFilterAgentConnector_ms": 0.04467786248050519, "StateBufferConnector_ms": 0.0014522182407663829, "ViewRequirementAgentConnector_ms": 0.0989878355567135}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 13159.88, "load_time_ms": 0.607, "load_throughput": 6584723.105, "learn_time_ms": 5207.054, "learn_throughput": 768.189, "synch_weights_time_ms": 2.355}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 67, "training_iteration": 16, "trial_id": "bfbe5_00000", "experiment_id": "9d397f7cc24449e6a0a9d132139c82a3", "date": "2023-03-20_16-14-48", "timestamp": 1679300088, "time_this_iter_s": 14.233002424240112, "time_total_s": 212.69298434257507, "pid": 20684, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002BA01308550>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x000002BA011F29D0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 212.69298434257507, "timesteps_since_restore": 0, "iterations_since_restore": 16, "warmup_time": 6.740259885787964, "perf": {"cpu_util_percent": 39.3421052631579, "ram_util_percent": 57.87894736842105}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.31698397609789514, "cur_kl_coeff": 0.011865234375000004, "cur_lr": 4.600000000000001e-05, "total_loss": 0.0037111102627472633, "policy_loss": 0.0030874839445616128, "vf_loss": 0.0011111752913398392, "vf_explained_var": -0.7096894519303435, "kl": 0.007596500511463312, "entropy": 0.002209439998951375, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 999.0, "episode_reward_min": -30.0, "episode_reward_mean": 808.0, "episode_len_mean": 947.1971830985915, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0, 419.0, 693.0, 683.0, 733.0, 767.0, 825.0, 835.0, 815.0, 839.0, 889.0, 879.0, 905.0, 915.0, 923.0, 927.0, 927.0, 943.0, 959.0, 949.0, 929.0, 947.0, 965.0, 969.0, 967.0, 975.0, 983.0, 973.0, 969.0, 991.0, 993.0, 997.0, 993.0, 993.0, 991.0, 991.0, 993.0, 989.0, 979.0, 973.0, 977.0, 981.0, 995.0, 999.0, 999.0, 997.0, 997.0, 993.0, 997.0, 997.0, 997.0, 997.0, 997.0, 997.0, 999.0, 999.0, 993.0, 999.0, 999.0, 999.0, 997.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3378546809100422, "mean_inference_ms": 1.095154617216482, "mean_action_processing_ms": 0.11781772756395731, "mean_env_wait_ms": 0.4995924558252989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.007184458450532295, "ObsPreprocessorConnector_ms": 0.002853299530459122, "MeanStdObservationFilterAgentConnector_ms": 0.043717572386835664, "StateBufferConnector_ms": 0.0013704031286105303, "ViewRequirementAgentConnector_ms": 0.09805954677957884}}, "episode_reward_max": 999.0, "episode_reward_min": -30.0, "episode_reward_mean": 808.0, "episode_len_mean": 947.1971830985915, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-24.0, 21.0, 16.0, 6.0, -1.0, -18.0, -30.0, 73.0, 337.0, 351.0, 347.0, 419.0, 693.0, 683.0, 733.0, 767.0, 825.0, 835.0, 815.0, 839.0, 889.0, 879.0, 905.0, 915.0, 923.0, 927.0, 927.0, 943.0, 959.0, 949.0, 929.0, 947.0, 965.0, 969.0, 967.0, 975.0, 983.0, 973.0, 969.0, 991.0, 993.0, 997.0, 993.0, 993.0, 991.0, 991.0, 993.0, 989.0, 979.0, 973.0, 977.0, 981.0, 995.0, 999.0, 999.0, 997.0, 997.0, 993.0, 997.0, 997.0, 997.0, 997.0, 997.0, 997.0, 999.0, 999.0, 993.0, 999.0, 999.0, 999.0, 997.0], "episode_lengths": [521, 532, 537, 519, 524, 521, 511, 586, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3378546809100422, "mean_inference_ms": 1.095154617216482, "mean_action_processing_ms": 0.11781772756395731, "mean_env_wait_ms": 0.4995924558252989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.007184458450532295, "ObsPreprocessorConnector_ms": 0.002853299530459122, "MeanStdObservationFilterAgentConnector_ms": 0.043717572386835664, "StateBufferConnector_ms": 0.0013704031286105303, "ViewRequirementAgentConnector_ms": 0.09805954677957884}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 13118.392, "load_time_ms": 0.616, "load_throughput": 6493484.538, "learn_time_ms": 5213.047, "learn_throughput": 767.306, "synch_weights_time_ms": 2.35}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": true, "episodes_total": 71, "training_iteration": 17, "trial_id": "bfbe5_00000", "experiment_id": "9d397f7cc24449e6a0a9d132139c82a3", "date": "2023-03-20_16-15-01", "timestamp": 1679300101, "time_this_iter_s": 12.517077684402466, "time_total_s": 225.21006202697754, "pid": 20684, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x000002BA01306880>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x000002BA01250A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 225.21006202697754, "timesteps_since_restore": 0, "iterations_since_restore": 17, "warmup_time": 6.740259885787964, "perf": {"cpu_util_percent": 20.922222222222224, "ram_util_percent": 57.900000000000006}}
