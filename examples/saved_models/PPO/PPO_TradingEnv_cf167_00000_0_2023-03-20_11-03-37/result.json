{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.021485636952103, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.10000000000000002, "total_loss": 0.30643828840505694, "policy_loss": -0.19563492987485182, "vf_loss": 0.9976157297370254, "vf_explained_var": 0.000301469910529352, "kl": 0.04871843660425139, "entropy": 0.6478333298237093, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": -1.0, "episode_reward_min": -44.0, "episode_reward_mean": -19.714285714285715, "episode_len_mean": 519.8571428571429, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35354042911315015, "mean_inference_ms": 1.1346225171231, "mean_action_processing_ms": 0.12498174837546717, "mean_env_wait_ms": 0.6066675455502885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0, "ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.08619512830461774, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09985310690743583}}, "episode_reward_max": -1.0, "episode_reward_min": -44.0, "episode_reward_mean": -19.714285714285715, "episode_len_mean": 519.8571428571429, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35354042911315015, "mean_inference_ms": 1.1346225171231, "mean_action_processing_ms": 0.12498174837546717, "mean_env_wait_ms": 0.6066675455502885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0, "ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.08619512830461774, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09985310690743583}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 14268.471, "load_time_ms": 0.969, "load_throughput": 4126221.348, "learn_time_ms": 5300.03, "learn_throughput": 754.713, "synch_weights_time_ms": 2.003}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 7, "training_iteration": 1, "trial_id": "cf167_00000", "experiment_id": "cf2183a860304799b469a9e50cfde37b", "date": "2023-03-20_11-04-06", "timestamp": 1679281446, "time_this_iter_s": 14.281439781188965, "time_total_s": 14.281439781188965, "pid": 17932, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000022C5A8813D0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x0000022C5A82DE50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 14.281439781188965, "timesteps_since_restore": 0, "iterations_since_restore": 1, "warmup_time": 6.7070534229278564, "perf": {"cpu_util_percent": 26.01904761904762, "ram_util_percent": 59.90000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2816299518910788, "cur_kl_coeff": 0.3, "cur_lr": 0.0007, "total_loss": 0.21122693474935267, "policy_loss": -0.2508723517178848, "vf_loss": 0.8599852824082939, "vf_explained_var": 0.0219751831664834, "kl": 0.1196473445648728, "entropy": 0.3787559984832682, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 393.0, "episode_reward_min": -44.0, "episode_reward_mean": 108.72727272727273, "episode_len_mean": 694.4545454545455, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0, 237.0, 355.0, 393.0, 349.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3511842253542367, "mean_inference_ms": 1.1289563728709913, "mean_action_processing_ms": 0.12566990322501684, "mean_env_wait_ms": 0.605955928472195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0, "ObsPreprocessorConnector_ms": 0.0091010873967951, "MeanStdObservationFilterAgentConnector_ms": 0.07299076427112926, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.11805187572132457}}, "episode_reward_max": 393.0, "episode_reward_min": -44.0, "episode_reward_mean": 108.72727272727273, "episode_len_mean": 694.4545454545455, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0, 237.0, 355.0, 393.0, 349.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3511842253542367, "mean_inference_ms": 1.1289563728709913, "mean_action_processing_ms": 0.12566990322501684, "mean_env_wait_ms": 0.605955928472195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0, "ObsPreprocessorConnector_ms": 0.0091010873967951, "MeanStdObservationFilterAgentConnector_ms": 0.07299076427112926, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.11805187572132457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 14178.104, "load_time_ms": 0.485, "load_throughput": 8252442.696, "learn_time_ms": 5302.0, "learn_throughput": 754.432, "synch_weights_time_ms": 2.002}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 11, "training_iteration": 2, "trial_id": "cf167_00000", "experiment_id": "cf2183a860304799b469a9e50cfde37b", "date": "2023-03-20_11-04-20", "timestamp": 1679281460, "time_this_iter_s": 14.09976077079773, "time_total_s": 28.381200551986694, "pid": 17932, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000022C5A8E4D00>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x0000022C5A82DF70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 28.381200551986694, "timesteps_since_restore": 0, "iterations_since_restore": 2, "warmup_time": 6.7070534229278564, "perf": {"cpu_util_percent": 25.51578947368421, "ram_util_percent": 59.79999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8271109235462963, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0003, "total_loss": 0.10897293107744346, "policy_loss": -0.13088331337297154, "vf_loss": 0.45721982012512863, "vf_explained_var": 0.029428347849076796, "kl": 0.03055286452016959, "entropy": 0.2502454122308121, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 753.0, "episode_reward_min": -44.0, "episode_reward_mean": 266.6666666666667, "episode_len_mean": 775.9333333333333, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0, 237.0, 355.0, 393.0, 349.0, 599.0, 753.0, 719.0, 733.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3506059294808298, "mean_inference_ms": 1.1295133731700888, "mean_action_processing_ms": 0.12549172704118736, "mean_env_wait_ms": 0.5971001205906478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.006670951843261719, "ObsPreprocessorConnector_ms": 0.006674130757649739, "MeanStdObservationFilterAgentConnector_ms": 0.06683667500813802, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.11992613474527995}}, "episode_reward_max": 753.0, "episode_reward_min": -44.0, "episode_reward_mean": 266.6666666666667, "episode_len_mean": 775.9333333333333, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0, 237.0, 355.0, 393.0, 349.0, 599.0, 753.0, 719.0, 733.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3506059294808298, "mean_inference_ms": 1.1295133731700888, "mean_action_processing_ms": 0.12549172704118736, "mean_env_wait_ms": 0.5971001205906478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.006670951843261719, "ObsPreprocessorConnector_ms": 0.006674130757649739, "MeanStdObservationFilterAgentConnector_ms": 0.06683667500813802, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.11992613474527995}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 14038.963, "load_time_ms": 0.323, "load_throughput": 12378664.043, "learn_time_ms": 5240.858, "learn_throughput": 763.234, "synch_weights_time_ms": 1.668}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 15, "training_iteration": 3, "trial_id": "cf167_00000", "experiment_id": "cf2183a860304799b469a9e50cfde37b", "date": "2023-03-20_11-04-34", "timestamp": 1679281474, "time_this_iter_s": 13.771831274032593, "time_total_s": 42.15303182601929, "pid": 17932, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000022C5A8F9580>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x0000022C5A82DEE0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 42.15303182601929, "timesteps_since_restore": 0, "iterations_since_restore": 3, "warmup_time": 6.7070534229278564, "perf": {"cpu_util_percent": 24.635, "ram_util_percent": 59.79999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6030123146150702, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 9.800000000000001e-05, "total_loss": 0.061974631679514725, "policy_loss": -0.08895413019213705, "vf_loss": 0.2944811439962797, "vf_explained_var": 0.02427398568840437, "kl": 0.008186267160197935, "entropy": 0.1837540835302363, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 847.0, "episode_reward_min": -44.0, "episode_reward_mean": 384.0, "episode_len_mean": 823.1052631578947, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0, 237.0, 355.0, 393.0, 349.0, 599.0, 753.0, 719.0, 733.0, 803.0, 847.0, 821.0, 825.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3498133746852438, "mean_inference_ms": 1.128457314296115, "mean_action_processing_ms": 0.1247435485601767, "mean_env_wait_ms": 0.585213839511866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.010524298015393709, "ObsPreprocessorConnector_ms": 0.005269050598144531, "MeanStdObservationFilterAgentConnector_ms": 0.05801476930317126, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09994381352474815}}, "episode_reward_max": 847.0, "episode_reward_min": -44.0, "episode_reward_mean": 384.0, "episode_len_mean": 823.1052631578947, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0, 237.0, 355.0, 393.0, 349.0, 599.0, 753.0, 719.0, 733.0, 803.0, 847.0, 821.0, 825.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3498133746852438, "mean_inference_ms": 1.128457314296115, "mean_action_processing_ms": 0.1247435485601767, "mean_env_wait_ms": 0.585213839511866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.010524298015393709, "ObsPreprocessorConnector_ms": 0.005269050598144531, "MeanStdObservationFilterAgentConnector_ms": 0.05801476930317126, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09994381352474815}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 13855.97, "load_time_ms": 0.242, "load_throughput": 16504885.391, "learn_time_ms": 5237.901, "learn_throughput": 763.665, "synch_weights_time_ms": 2.243}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 19, "training_iteration": 4, "trial_id": "cf167_00000", "experiment_id": "cf2183a860304799b469a9e50cfde37b", "date": "2023-03-20_11-04-47", "timestamp": 1679281487, "time_this_iter_s": 13.318992853164673, "time_total_s": 55.47202467918396, "pid": 17932, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000022C5A8F9EE0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x0000022B2E858700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 55.47202467918396, "timesteps_since_restore": 0, "iterations_since_restore": 4, "warmup_time": 6.7070534229278564, "perf": {"cpu_util_percent": 23.847368421052632, "ram_util_percent": 59.8421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5773139423340239, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 9.4e-05, "total_loss": 0.023276024023621715, "policy_loss": -0.06636909007505383, "vf_loss": 0.17579840620358786, "vf_explained_var": 0.024087119358842092, "kl": 0.004559880769373422, "entropy": 0.13320084567512236, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 909.0, "episode_reward_min": -44.0, "episode_reward_mean": 473.39130434782606, "episode_len_mean": 853.8695652173913, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0, 237.0, 355.0, 393.0, 349.0, 599.0, 753.0, 719.0, 733.0, 803.0, 847.0, 821.0, 825.0, 871.0, 909.0, 907.0, 905.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34905347946218296, "mean_inference_ms": 1.1277960309516764, "mean_action_processing_ms": 0.124487722653857, "mean_env_wait_ms": 0.5735613087252425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.008693985317064367, "ObsPreprocessorConnector_ms": 0.004352693972380265, "MeanStdObservationFilterAgentConnector_ms": 0.05663892497187075, "StateBufferConnector_ms": 0.004211716029954993, "ViewRequirementAgentConnector_ms": 0.09563280188519022}}, "episode_reward_max": 909.0, "episode_reward_min": -44.0, "episode_reward_mean": 473.39130434782606, "episode_len_mean": 853.8695652173913, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0, 237.0, 355.0, 393.0, 349.0, 599.0, 753.0, 719.0, 733.0, 803.0, 847.0, 821.0, 825.0, 871.0, 909.0, 907.0, 905.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34905347946218296, "mean_inference_ms": 1.1277960309516764, "mean_action_processing_ms": 0.124487722653857, "mean_env_wait_ms": 0.5735613087252425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.008693985317064367, "ObsPreprocessorConnector_ms": 0.004352693972380265, "MeanStdObservationFilterAgentConnector_ms": 0.05663892497187075, "StateBufferConnector_ms": 0.004211716029954993, "ViewRequirementAgentConnector_ms": 0.09563280188519022}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 13792.176, "load_time_ms": 0.194, "load_throughput": 20631106.739, "learn_time_ms": 5261.726, "learn_throughput": 760.207, "synch_weights_time_ms": 2.595}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 23, "training_iteration": 5, "trial_id": "cf167_00000", "experiment_id": "cf2183a860304799b469a9e50cfde37b", "date": "2023-03-20_11-05-01", "timestamp": 1679281501, "time_this_iter_s": 13.550026655197144, "time_total_s": 69.0220513343811, "pid": 17932, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000022C5A8F9430>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x0000022C5A82DE50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 69.0220513343811, "timesteps_since_restore": 0, "iterations_since_restore": 5, "warmup_time": 6.7070534229278564, "perf": {"cpu_util_percent": 25.97368421052631, "ram_util_percent": 59.900000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5876870602849991, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 9e-05, "total_loss": 0.015478031556197112, "policy_loss": -0.05285029099923709, "vf_loss": 0.13539446179444592, "vf_explained_var": -0.02147853842345617, "kl": 0.004480548884743336, "entropy": 0.0881093271477248, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 945.0, "episode_reward_min": -44.0, "episode_reward_mean": 540.4444444444445, "episode_len_mean": 875.5185185185185, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0, 237.0, 355.0, 393.0, 349.0, 599.0, 753.0, 719.0, 733.0, 803.0, 847.0, 821.0, 825.0, 871.0, 909.0, 907.0, 905.0, 915.0, 921.0, 923.0, 945.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34812690314432054, "mean_inference_ms": 1.1255762698481588, "mean_action_processing_ms": 0.12391210468027918, "mean_env_wait_ms": 0.561945763607331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0074059874923140916, "ObsPreprocessorConnector_ms": 0.003707850420916522, "MeanStdObservationFilterAgentConnector_ms": 0.05934856556080006, "StateBufferConnector_ms": 0.0035877580995912904, "ViewRequirementAgentConnector_ms": 0.08886743474889684}}, "episode_reward_max": 945.0, "episode_reward_min": -44.0, "episode_reward_mean": 540.4444444444445, "episode_len_mean": 875.5185185185185, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0, 237.0, 355.0, 393.0, 349.0, 599.0, 753.0, 719.0, 733.0, 803.0, 847.0, 821.0, 825.0, 871.0, 909.0, 907.0, 905.0, 915.0, 921.0, 923.0, 945.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34812690314432054, "mean_inference_ms": 1.1255762698481588, "mean_action_processing_ms": 0.12391210468027918, "mean_env_wait_ms": 0.561945763607331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0074059874923140916, "ObsPreprocessorConnector_ms": 0.003707850420916522, "MeanStdObservationFilterAgentConnector_ms": 0.05934856556080006, "StateBufferConnector_ms": 0.0035877580995912904, "ViewRequirementAgentConnector_ms": 0.08886743474889684}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 13664.646, "load_time_ms": 0.324, "load_throughput": 12345265.636, "learn_time_ms": 5293.777, "learn_throughput": 755.604, "synch_weights_time_ms": 2.329}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 27, "training_iteration": 6, "trial_id": "cf167_00000", "experiment_id": "cf2183a860304799b469a9e50cfde37b", "date": "2023-03-20_11-05-14", "timestamp": 1679281514, "time_this_iter_s": 13.03798794746399, "time_total_s": 82.06003928184509, "pid": 17932, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000022C5A8F61F0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x0000022C5A7D75E0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 82.06003928184509, "timesteps_since_restore": 0, "iterations_since_restore": 6, "warmup_time": 6.7070534229278564, "perf": {"cpu_util_percent": 24.950000000000003, "ram_util_percent": 59.900000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4765601960741865, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 8.599999999999999e-05, "total_loss": -0.0063853283768259385, "policy_loss": -0.0345735826509534, "vf_loss": 0.055635542940682924, "vf_explained_var": -0.06110471781863961, "kl": 0.005364137633863586, "entropy": 0.05347150951944372, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 977.0, "episode_reward_min": -44.0, "episode_reward_mean": 595.4193548387096, "episode_len_mean": 891.5806451612904, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0, 237.0, 355.0, 393.0, 349.0, 599.0, 753.0, 719.0, 733.0, 803.0, 847.0, 821.0, 825.0, 871.0, 909.0, 907.0, 905.0, 915.0, 921.0, 923.0, 945.0, 951.0, 977.0, 975.0, 963.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.347379354767844, "mean_inference_ms": 1.123833485207005, "mean_action_processing_ms": 0.12355142789112933, "mean_env_wait_ms": 0.5510618374988596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.006450376202983241, "ObsPreprocessorConnector_ms": 0.0032294181085401968, "MeanStdObservationFilterAgentConnector_ms": 0.05813337141467679, "StateBufferConnector_ms": 0.003124821570611769, "ViewRequirementAgentConnector_ms": 0.09698098705660912}}, "episode_reward_max": 977.0, "episode_reward_min": -44.0, "episode_reward_mean": 595.4193548387096, "episode_len_mean": 891.5806451612904, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0, 237.0, 355.0, 393.0, 349.0, 599.0, 753.0, 719.0, 733.0, 803.0, 847.0, 821.0, 825.0, 871.0, 909.0, 907.0, 905.0, 915.0, 921.0, 923.0, 945.0, 951.0, 977.0, 975.0, 963.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.347379354767844, "mean_inference_ms": 1.123833485207005, "mean_action_processing_ms": 0.12355142789112933, "mean_env_wait_ms": 0.5510618374988596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.006450376202983241, "ObsPreprocessorConnector_ms": 0.0032294181085401968, "MeanStdObservationFilterAgentConnector_ms": 0.05813337141467679, "StateBufferConnector_ms": 0.003124821570611769, "ViewRequirementAgentConnector_ms": 0.09698098705660912}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 13624.16, "load_time_ms": 0.419, "load_throughput": 9538703.054, "learn_time_ms": 5323.666, "learn_throughput": 751.362, "synch_weights_time_ms": 2.282}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 31, "training_iteration": 7, "trial_id": "cf167_00000", "experiment_id": "cf2183a860304799b469a9e50cfde37b", "date": "2023-03-20_11-05-27", "timestamp": 1679281527, "time_this_iter_s": 13.393243074417114, "time_total_s": 95.4532823562622, "pid": 17932, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000022C5A8F67F0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x0000022B2E858700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 95.4532823562622, "timesteps_since_restore": 0, "iterations_since_restore": 7, "warmup_time": 6.7070534229278564, "perf": {"cpu_util_percent": 27.810526315789474, "ram_util_percent": 59.95789473684211}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4900747348203935, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 8.200000000000003e-05, "total_loss": -0.0043185589488931204, "policy_loss": -0.025900117322422003, "vf_loss": 0.041986966028390825, "vf_explained_var": -0.16116735710892627, "kl": 0.005616086209540341, "entropy": 0.03596395160201737, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 983.0, "episode_reward_min": -44.0, "episode_reward_mean": 639.0857142857143, "episode_len_mean": 903.9714285714285, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0, 237.0, 355.0, 393.0, 349.0, 599.0, 753.0, 719.0, 733.0, 803.0, 847.0, 821.0, 825.0, 871.0, 909.0, 907.0, 905.0, 915.0, 921.0, 923.0, 945.0, 951.0, 977.0, 975.0, 963.0, 975.0, 983.0, 977.0, 975.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3471834661663703, "mean_inference_ms": 1.123175720198277, "mean_action_processing_ms": 0.12352606592390362, "mean_env_wait_ms": 0.5414578750514606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.005713190351213727, "ObsPreprocessorConnector_ms": 0.0028603417532784598, "MeanStdObservationFilterAgentConnector_ms": 0.06862095424107142, "StateBufferConnector_ms": 0.0027676991053989957, "ViewRequirementAgentConnector_ms": 0.091684205191476}}, "episode_reward_max": 983.0, "episode_reward_min": -44.0, "episode_reward_mean": 639.0857142857143, "episode_len_mean": 903.9714285714285, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0, 237.0, 355.0, 393.0, 349.0, 599.0, 753.0, 719.0, 733.0, 803.0, 847.0, 821.0, 825.0, 871.0, 909.0, 907.0, 905.0, 915.0, 921.0, 923.0, 945.0, 951.0, 977.0, 975.0, 963.0, 975.0, 983.0, 977.0, 975.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3471834661663703, "mean_inference_ms": 1.123175720198277, "mean_action_processing_ms": 0.12352606592390362, "mean_env_wait_ms": 0.5414578750514606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.005713190351213727, "ObsPreprocessorConnector_ms": 0.0028603417532784598, "MeanStdObservationFilterAgentConnector_ms": 0.06862095424107142, "StateBufferConnector_ms": 0.0027676991053989957, "ViewRequirementAgentConnector_ms": 0.091684205191476}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 13613.015, "load_time_ms": 0.492, "load_throughput": 8131450.866, "learn_time_ms": 5308.337, "learn_throughput": 753.532, "synch_weights_time_ms": 2.243}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 35, "training_iteration": 8, "trial_id": "cf167_00000", "experiment_id": "cf2183a860304799b469a9e50cfde37b", "date": "2023-03-20_11-05-41", "timestamp": 1679281541, "time_this_iter_s": 13.54800009727478, "time_total_s": 109.00128245353699, "pid": 17932, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000022C5A8F6DC0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x0000022C5A82DF70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 109.00128245353699, "timesteps_since_restore": 0, "iterations_since_restore": 8, "warmup_time": 6.7070534229278564, "perf": {"cpu_util_percent": 27.021052631578947, "ram_util_percent": 60.16842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.22060120821359658, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 7.799999999999997e-05, "total_loss": -0.010008145643458252, "policy_loss": -0.02426525427489191, "vf_loss": 0.02787430972154349, "vf_explained_var": -0.22710050530331108, "kl": 0.003200579204396291, "entropy": 0.022014430188323542, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 987.0, "episode_reward_min": -44.0, "episode_reward_mean": 674.4102564102565, "episode_len_mean": 913.8205128205128, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0, 237.0, 355.0, 393.0, 349.0, 599.0, 753.0, 719.0, 733.0, 803.0, 847.0, 821.0, 825.0, 871.0, 909.0, 907.0, 905.0, 915.0, 921.0, 923.0, 945.0, 951.0, 977.0, 975.0, 963.0, 975.0, 983.0, 977.0, 975.0, 985.0, 979.0, 983.0, 987.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.346980468761033, "mean_inference_ms": 1.1225127821893708, "mean_action_processing_ms": 0.12341429383923747, "mean_env_wait_ms": 0.5328048308948653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.005127222110063602, "ObsPreprocessorConnector_ms": 0.0025669733683268228, "MeanStdObservationFilterAgentConnector_ms": 0.06414743570181039, "StateBufferConnector_ms": 0.0024838325304862782, "ViewRequirementAgentConnector_ms": 0.10266548547989283}}, "episode_reward_max": 987.0, "episode_reward_min": -44.0, "episode_reward_mean": 674.4102564102565, "episode_len_mean": 913.8205128205128, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0, 237.0, 355.0, 393.0, 349.0, 599.0, 753.0, 719.0, 733.0, 803.0, 847.0, 821.0, 825.0, 871.0, 909.0, 907.0, 905.0, 915.0, 921.0, 923.0, 945.0, 951.0, 977.0, 975.0, 963.0, 975.0, 983.0, 977.0, 975.0, 985.0, 979.0, 983.0, 987.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.346980468761033, "mean_inference_ms": 1.1225127821893708, "mean_action_processing_ms": 0.12341429383923747, "mean_env_wait_ms": 0.5328048308948653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.005127222110063602, "ObsPreprocessorConnector_ms": 0.0025669733683268228, "MeanStdObservationFilterAgentConnector_ms": 0.06414743570181039, "StateBufferConnector_ms": 0.0024838325304862782, "ViewRequirementAgentConnector_ms": 0.10266548547989283}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 13547.931, "load_time_ms": 0.437, "load_throughput": 9147882.225, "learn_time_ms": 5296.578, "learn_throughput": 755.205, "synch_weights_time_ms": 2.105}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 39, "training_iteration": 9, "trial_id": "cf167_00000", "experiment_id": "cf2183a860304799b469a9e50cfde37b", "date": "2023-03-20_11-05-54", "timestamp": 1679281554, "time_this_iter_s": 13.03828763961792, "time_total_s": 122.03957009315491, "pid": 17932, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000022C5A8E4AF0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x0000022C5A82DEE0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 122.03957009315491, "timesteps_since_restore": 0, "iterations_since_restore": 9, "warmup_time": 6.7070534229278564, "perf": {"cpu_util_percent": 25.938888888888886, "ram_util_percent": 60.272222222222226}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8689423516262523, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 7.400000000000004e-05, "total_loss": 0.019147652753513628, "policy_loss": 0.00895949548250565, "vf_loss": 0.018660269814166876, "vf_explained_var": -0.33532315704130355, "kl": 0.011211704457048579, "entropy": 0.008796538580058803, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 993.0, "episode_reward_min": -44.0, "episode_reward_mean": 703.6744186046511, "episode_len_mean": 921.8372093023256, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0, 237.0, 355.0, 393.0, 349.0, 599.0, 753.0, 719.0, 733.0, 803.0, 847.0, 821.0, 825.0, 871.0, 909.0, 907.0, 905.0, 915.0, 921.0, 923.0, 945.0, 951.0, 977.0, 975.0, 963.0, 975.0, 983.0, 977.0, 975.0, 985.0, 979.0, 983.0, 987.0, 989.0, 985.0, 989.0, 993.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3466646163618149, "mean_inference_ms": 1.1217568565830103, "mean_action_processing_ms": 0.12337044959821326, "mean_env_wait_ms": 0.5247521053271448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.004650271216104197, "ObsPreprocessorConnector_ms": 0.002328185148017351, "MeanStdObservationFilterAgentConnector_ms": 0.06515702535939771, "StateBufferConnector_ms": 0.0022527783416038337, "ViewRequirementAgentConnector_ms": 0.09543673936710802}}, "episode_reward_max": 993.0, "episode_reward_min": -44.0, "episode_reward_mean": 703.6744186046511, "episode_len_mean": 921.8372093023256, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0, 237.0, 355.0, 393.0, 349.0, 599.0, 753.0, 719.0, 733.0, 803.0, 847.0, 821.0, 825.0, 871.0, 909.0, 907.0, 905.0, 915.0, 921.0, 923.0, 945.0, 951.0, 977.0, 975.0, 963.0, 975.0, 983.0, 977.0, 975.0, 985.0, 979.0, 983.0, 987.0, 989.0, 985.0, 989.0, 993.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3466646163618149, "mean_inference_ms": 1.1217568565830103, "mean_action_processing_ms": 0.12337044959821326, "mean_env_wait_ms": 0.5247521053271448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.004650271216104197, "ObsPreprocessorConnector_ms": 0.002328185148017351, "MeanStdObservationFilterAgentConnector_ms": 0.06515702535939771, "StateBufferConnector_ms": 0.0022527783416038337, "ViewRequirementAgentConnector_ms": 0.09543673936710802}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 13481.592, "load_time_ms": 0.394, "load_throughput": 10164313.583, "learn_time_ms": 5287.959, "learn_throughput": 756.436, "synch_weights_time_ms": 2.094}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 43, "training_iteration": 10, "trial_id": "cf167_00000", "experiment_id": "cf2183a860304799b469a9e50cfde37b", "date": "2023-03-20_11-06-07", "timestamp": 1679281567, "time_this_iter_s": 12.895180463790894, "time_total_s": 134.9347505569458, "pid": 17932, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000022C5A847130>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x0000022C5A82DE50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 134.9347505569458, "timesteps_since_restore": 0, "iterations_since_restore": 10, "warmup_time": 6.7070534229278564, "perf": {"cpu_util_percent": 25.349999999999998, "ram_util_percent": 58.333333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5693300376536063, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 7e-05, "total_loss": 0.15245882450748155, "policy_loss": 0.145770596622199, "vf_loss": 0.01109434154131005, "vf_explained_var": -0.32276347388503374, "kl": 0.014228211674716357, "entropy": 0.005945172722912043, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 993.0, "episode_reward_min": -44.0, "episode_reward_mean": 728.2978723404256, "episode_len_mean": 928.4893617021277, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0, 237.0, 355.0, 393.0, 349.0, 599.0, 753.0, 719.0, 733.0, 803.0, 847.0, 821.0, 825.0, 871.0, 909.0, 907.0, 905.0, 915.0, 921.0, 923.0, 945.0, 951.0, 977.0, 975.0, 963.0, 975.0, 983.0, 977.0, 975.0, 985.0, 979.0, 983.0, 987.0, 989.0, 985.0, 989.0, 993.0, 993.0, 993.0, 993.0, 993.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3463857552106005, "mean_inference_ms": 1.120784092199546, "mean_action_processing_ms": 0.12330149103864654, "mean_env_wait_ms": 0.5172802739667548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.004254503453031499, "ObsPreprocessorConnector_ms": 0.0021300417311648106, "MeanStdObservationFilterAgentConnector_ms": 0.06805886613561753, "StateBufferConnector_ms": 0.004188050615026596, "ViewRequirementAgentConnector_ms": 0.10221004486083984}}, "episode_reward_max": 993.0, "episode_reward_min": -44.0, "episode_reward_mean": 728.2978723404256, "episode_len_mean": 928.4893617021277, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0, 237.0, 355.0, 393.0, 349.0, 599.0, 753.0, 719.0, 733.0, 803.0, 847.0, 821.0, 825.0, 871.0, 909.0, 907.0, 905.0, 915.0, 921.0, 923.0, 945.0, 951.0, 977.0, 975.0, 963.0, 975.0, 983.0, 977.0, 975.0, 985.0, 979.0, 983.0, 987.0, 989.0, 985.0, 989.0, 993.0, 993.0, 993.0, 993.0, 993.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3463857552106005, "mean_inference_ms": 1.120784092199546, "mean_action_processing_ms": 0.12330149103864654, "mean_env_wait_ms": 0.5172802739667548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.004254503453031499, "ObsPreprocessorConnector_ms": 0.0021300417311648106, "MeanStdObservationFilterAgentConnector_ms": 0.06805886613561753, "StateBufferConnector_ms": 0.004188050615026596, "ViewRequirementAgentConnector_ms": 0.10221004486083984}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 13327.174, "load_time_ms": 0.297, "load_throughput": 13486508.039, "learn_time_ms": 5273.873, "learn_throughput": 758.456, "synch_weights_time_ms": 2.091}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 47, "training_iteration": 11, "trial_id": "cf167_00000", "experiment_id": "cf2183a860304799b469a9e50cfde37b", "date": "2023-03-20_11-06-20", "timestamp": 1679281580, "time_this_iter_s": 12.736316204071045, "time_total_s": 147.67106676101685, "pid": 17932, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000022C5A8F6700>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x0000022C5A6DA550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 147.67106676101685, "timesteps_since_restore": 0, "iterations_since_restore": 11, "warmup_time": 6.7070534229278564, "perf": {"cpu_util_percent": 21.58888888888889, "ram_util_percent": 57.772222222222226}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2465837734027876, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 6.599999999999998e-05, "total_loss": -0.0115795225265526, "policy_loss": -0.02046451690025948, "vf_loss": 0.016710023934735536, "vf_explained_var": -0.0849657654121358, "kl": 0.0068013021027045345, "entropy": 0.0043877293131694755, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 993.0, "episode_reward_min": -44.0, "episode_reward_mean": 748.7450980392157, "episode_len_mean": 934.0980392156863, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0, 237.0, 355.0, 393.0, 349.0, 599.0, 753.0, 719.0, 733.0, 803.0, 847.0, 821.0, 825.0, 871.0, 909.0, 907.0, 905.0, 915.0, 921.0, 923.0, 945.0, 951.0, 977.0, 975.0, 963.0, 975.0, 983.0, 977.0, 975.0, 985.0, 979.0, 983.0, 987.0, 989.0, 985.0, 989.0, 993.0, 993.0, 993.0, 993.0, 993.0, 991.0, 989.0, 989.0, 987.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34616807288484797, "mean_inference_ms": 1.1196899168616097, "mean_action_processing_ms": 0.12321176994128574, "mean_env_wait_ms": 0.510370113973719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.003920816907695695, "ObsPreprocessorConnector_ms": 0.003919881932875689, "MeanStdObservationFilterAgentConnector_ms": 0.06860985475427964, "StateBufferConnector_ms": 0.003859576056985294, "ViewRequirementAgentConnector_ms": 0.11382804197423599}}, "episode_reward_max": 993.0, "episode_reward_min": -44.0, "episode_reward_mean": 748.7450980392157, "episode_len_mean": 934.0980392156863, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0, 237.0, 355.0, 393.0, 349.0, 599.0, 753.0, 719.0, 733.0, 803.0, 847.0, 821.0, 825.0, 871.0, 909.0, 907.0, 905.0, 915.0, 921.0, 923.0, 945.0, 951.0, 977.0, 975.0, 963.0, 975.0, 983.0, 977.0, 975.0, 985.0, 979.0, 983.0, 987.0, 989.0, 985.0, 989.0, 993.0, 993.0, 993.0, 993.0, 993.0, 991.0, 989.0, 989.0, 987.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34616807288484797, "mean_inference_ms": 1.1196899168616097, "mean_action_processing_ms": 0.12321176994128574, "mean_env_wait_ms": 0.510370113973719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.003920816907695695, "ObsPreprocessorConnector_ms": 0.003919881932875689, "MeanStdObservationFilterAgentConnector_ms": 0.06860985475427964, "StateBufferConnector_ms": 0.003859576056985294, "ViewRequirementAgentConnector_ms": 0.11382804197423599}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 13214.519, "load_time_ms": 0.397, "load_throughput": 10075800.853, "learn_time_ms": 5281.708, "learn_throughput": 757.331, "synch_weights_time_ms": 2.295}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 51, "training_iteration": 12, "trial_id": "cf167_00000", "experiment_id": "cf2183a860304799b469a9e50cfde37b", "date": "2023-03-20_11-06-33", "timestamp": 1679281593, "time_this_iter_s": 12.972344636917114, "time_total_s": 160.64341139793396, "pid": 17932, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000022C5A847FA0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x0000022C5A7D75E0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 160.64341139793396, "timesteps_since_restore": 0, "iterations_since_restore": 12, "warmup_time": 6.7070534229278564, "perf": {"cpu_util_percent": 23.48421052631579, "ram_util_percent": 57.70000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.36690771327008526, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 6.2e-05, "total_loss": -0.00691583787143651, "policy_loss": -0.008860024174435004, "vf_loss": 0.003884967483046601, "vf_explained_var": -0.5970501478641264, "kl": 0.0005388972777274504, "entropy": 0.0043766815656600825, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 997.0, "episode_reward_min": -44.0, "episode_reward_mean": 766.7272727272727, "episode_len_mean": 938.8909090909091, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0, 237.0, 355.0, 393.0, 349.0, 599.0, 753.0, 719.0, 733.0, 803.0, 847.0, 821.0, 825.0, 871.0, 909.0, 907.0, 905.0, 915.0, 921.0, 923.0, 945.0, 951.0, 977.0, 975.0, 963.0, 975.0, 983.0, 977.0, 975.0, 985.0, 979.0, 983.0, 987.0, 989.0, 985.0, 989.0, 993.0, 993.0, 993.0, 993.0, 993.0, 991.0, 989.0, 989.0, 987.0, 995.0, 995.0, 997.0, 997.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3458637666516726, "mean_inference_ms": 1.1186206187715084, "mean_action_processing_ms": 0.12318167042385555, "mean_env_wait_ms": 0.5040965158077644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0036356665871360087, "ObsPreprocessorConnector_ms": 0.0036347996104847302, "MeanStdObservationFilterAgentConnector_ms": 0.06906856190074574, "StateBufferConnector_ms": 0.0035788796164772725, "ViewRequirementAgentConnector_ms": 0.11459523981267755}}, "episode_reward_max": 997.0, "episode_reward_min": -44.0, "episode_reward_mean": 766.7272727272727, "episode_len_mean": 938.8909090909091, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0, 237.0, 355.0, 393.0, 349.0, 599.0, 753.0, 719.0, 733.0, 803.0, 847.0, 821.0, 825.0, 871.0, 909.0, 907.0, 905.0, 915.0, 921.0, 923.0, 945.0, 951.0, 977.0, 975.0, 963.0, 975.0, 983.0, 977.0, 975.0, 985.0, 979.0, 983.0, 987.0, 989.0, 985.0, 989.0, 993.0, 993.0, 993.0, 993.0, 993.0, 991.0, 989.0, 989.0, 987.0, 995.0, 995.0, 997.0, 997.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3458637666516726, "mean_inference_ms": 1.1186206187715084, "mean_action_processing_ms": 0.12318167042385555, "mean_env_wait_ms": 0.5040965158077644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0036356665871360087, "ObsPreprocessorConnector_ms": 0.0036347996104847302, "MeanStdObservationFilterAgentConnector_ms": 0.06906856190074574, "StateBufferConnector_ms": 0.0035788796164772725, "ViewRequirementAgentConnector_ms": 0.11459523981267755}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 13132.184, "load_time_ms": 0.497, "load_throughput": 8045082.958, "learn_time_ms": 5295.84, "learn_throughput": 755.31, "synch_weights_time_ms": 2.398}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 55, "training_iteration": 13, "trial_id": "cf167_00000", "experiment_id": "cf2183a860304799b469a9e50cfde37b", "date": "2023-03-20_11-06-46", "timestamp": 1679281606, "time_this_iter_s": 12.949222326278687, "time_total_s": 173.59263372421265, "pid": 17932, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000022C5A847400>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x0000022C5A879DC0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 173.59263372421265, "timesteps_since_restore": 0, "iterations_since_restore": 13, "warmup_time": 6.7070534229278564, "perf": {"cpu_util_percent": 27.133333333333333, "ram_util_percent": 57.71666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9669547328708559, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.8e-05, "total_loss": 0.01624143552413756, "policy_loss": 0.01368858484796659, "vf_loss": 0.004788352000126349, "vf_explained_var": -0.5670122269020286, "kl": 0.0048088513938467645, "entropy": 0.0044197589991443985, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 999.0, "episode_reward_min": -44.0, "episode_reward_mean": 782.3050847457627, "episode_len_mean": 943.0338983050848, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0, 237.0, 355.0, 393.0, 349.0, 599.0, 753.0, 719.0, 733.0, 803.0, 847.0, 821.0, 825.0, 871.0, 909.0, 907.0, 905.0, 915.0, 921.0, 923.0, 945.0, 951.0, 977.0, 975.0, 963.0, 975.0, 983.0, 977.0, 975.0, 985.0, 979.0, 983.0, 987.0, 989.0, 985.0, 989.0, 993.0, 993.0, 993.0, 993.0, 993.0, 991.0, 989.0, 989.0, 987.0, 995.0, 995.0, 997.0, 997.0, 999.0, 995.0, 995.0, 997.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34555246672421713, "mean_inference_ms": 1.1175170946347646, "mean_action_processing_ms": 0.12313314515785036, "mean_env_wait_ms": 0.4982126624497732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.003389180716821703, "ObsPreprocessorConnector_ms": 0.0033883725182484773, "MeanStdObservationFilterAgentConnector_ms": 0.06947274935447563, "StateBufferConnector_ms": 0.0033362437102754236, "ViewRequirementAgentConnector_ms": 0.11191691382456634}}, "episode_reward_max": 999.0, "episode_reward_min": -44.0, "episode_reward_mean": 782.3050847457627, "episode_len_mean": 943.0338983050848, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0, 237.0, 355.0, 393.0, 349.0, 599.0, 753.0, 719.0, 733.0, 803.0, 847.0, 821.0, 825.0, 871.0, 909.0, 907.0, 905.0, 915.0, 921.0, 923.0, 945.0, 951.0, 977.0, 975.0, 963.0, 975.0, 983.0, 977.0, 975.0, 985.0, 979.0, 983.0, 987.0, 989.0, 985.0, 989.0, 993.0, 993.0, 993.0, 993.0, 993.0, 991.0, 989.0, 989.0, 987.0, 995.0, 995.0, 997.0, 997.0, 999.0, 995.0, 995.0, 997.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34555246672421713, "mean_inference_ms": 1.1175170946347646, "mean_action_processing_ms": 0.12313314515785036, "mean_env_wait_ms": 0.4982126624497732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.003389180716821703, "ObsPreprocessorConnector_ms": 0.0033883725182484773, "MeanStdObservationFilterAgentConnector_ms": 0.06947274935447563, "StateBufferConnector_ms": 0.0033362437102754236, "ViewRequirementAgentConnector_ms": 0.11191691382456634}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 13063.421, "load_time_ms": 0.497, "load_throughput": 8045082.958, "learn_time_ms": 5288.335, "learn_throughput": 756.382, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 59, "training_iteration": 14, "trial_id": "cf167_00000", "experiment_id": "cf2183a860304799b469a9e50cfde37b", "date": "2023-03-20_11-06-58", "timestamp": 1679281618, "time_this_iter_s": 12.631396293640137, "time_total_s": 186.22403001785278, "pid": 17932, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000022C5A8FB070>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x0000022B2E8CE700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 186.22403001785278, "timesteps_since_restore": 0, "iterations_since_restore": 14, "warmup_time": 6.7070534229278564, "perf": {"cpu_util_percent": 22.400000000000002, "ram_util_percent": 57.77647058823529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.48538769490088046, "cur_kl_coeff": 0.021093750000000005, "cur_lr": 5.4e-05, "total_loss": -0.0057149616826165425, "policy_loss": -0.008445079571076779, "vf_loss": 0.005495850188061169, "vf_explained_var": -0.6382752851773333, "kl": 0.0008096275631206935, "entropy": 0.0034885980332801016, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 999.0, "episode_reward_min": -44.0, "episode_reward_mean": 795.8730158730159, "episode_len_mean": 946.6507936507936, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0, 237.0, 355.0, 393.0, 349.0, 599.0, 753.0, 719.0, 733.0, 803.0, 847.0, 821.0, 825.0, 871.0, 909.0, 907.0, 905.0, 915.0, 921.0, 923.0, 945.0, 951.0, 977.0, 975.0, 963.0, 975.0, 983.0, 977.0, 975.0, 985.0, 979.0, 983.0, 987.0, 989.0, 985.0, 989.0, 993.0, 993.0, 993.0, 993.0, 993.0, 991.0, 989.0, 989.0, 987.0, 995.0, 995.0, 997.0, 997.0, 999.0, 995.0, 995.0, 997.0, 995.0, 995.0, 999.0, 995.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34525406171704953, "mean_inference_ms": 1.1164651971812674, "mean_action_processing_ms": 0.12308373630322722, "mean_env_wait_ms": 0.4927342070412719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0031739946395631822, "ObsPreprocessorConnector_ms": 0.0031732377551850818, "MeanStdObservationFilterAgentConnector_ms": 0.06669854360913473, "StateBufferConnector_ms": 0.003124418712797619, "ViewRequirementAgentConnector_ms": 0.11274511851961651}}, "episode_reward_max": 999.0, "episode_reward_min": -44.0, "episode_reward_mean": 795.8730158730159, "episode_len_mean": 946.6507936507936, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0, 237.0, 355.0, 393.0, 349.0, 599.0, 753.0, 719.0, 733.0, 803.0, 847.0, 821.0, 825.0, 871.0, 909.0, 907.0, 905.0, 915.0, 921.0, 923.0, 945.0, 951.0, 977.0, 975.0, 963.0, 975.0, 983.0, 977.0, 975.0, 985.0, 979.0, 983.0, 987.0, 989.0, 985.0, 989.0, 993.0, 993.0, 993.0, 993.0, 993.0, 991.0, 989.0, 989.0, 987.0, 995.0, 995.0, 997.0, 997.0, 999.0, 995.0, 995.0, 997.0, 995.0, 995.0, 999.0, 995.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34525406171704953, "mean_inference_ms": 1.1164651971812674, "mean_action_processing_ms": 0.12308373630322722, "mean_env_wait_ms": 0.4927342070412719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.0031739946395631822, "ObsPreprocessorConnector_ms": 0.0031732377551850818, "MeanStdObservationFilterAgentConnector_ms": 0.06669854360913473, "StateBufferConnector_ms": 0.003124418712797619, "ViewRequirementAgentConnector_ms": 0.11274511851961651}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12987.103, "load_time_ms": 0.497, "load_throughput": 8045082.958, "learn_time_ms": 5271.707, "learn_throughput": 758.768, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 63, "training_iteration": 15, "trial_id": "cf167_00000", "experiment_id": "cf2183a860304799b469a9e50cfde37b", "date": "2023-03-20_11-07-11", "timestamp": 1679281631, "time_this_iter_s": 12.78481936454773, "time_total_s": 199.0088493824005, "pid": 17932, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000022C5A8477F0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x0000022C5A7F9160>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 199.0088493824005, "timesteps_since_restore": 0, "iterations_since_restore": 15, "warmup_time": 6.7070534229278564, "perf": {"cpu_util_percent": 23.02105263157895, "ram_util_percent": 57.931578947368415}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4545963353683962, "cur_kl_coeff": 0.010546875000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.16283065790150275, "policy_loss": 0.15861222602512126, "vf_loss": 0.007839822874736103, "vf_explained_var": -0.5404831071694692, "kl": 0.031088905587904638, "entropy": 0.0029371585653749327, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 999.0, "episode_reward_min": -44.0, "episode_reward_mean": 807.7611940298508, "episode_len_mean": 949.8358208955224, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0, 237.0, 355.0, 393.0, 349.0, 599.0, 753.0, 719.0, 733.0, 803.0, 847.0, 821.0, 825.0, 871.0, 909.0, 907.0, 905.0, 915.0, 921.0, 923.0, 945.0, 951.0, 977.0, 975.0, 963.0, 975.0, 983.0, 977.0, 975.0, 985.0, 979.0, 983.0, 987.0, 989.0, 985.0, 989.0, 993.0, 993.0, 993.0, 993.0, 993.0, 991.0, 989.0, 989.0, 987.0, 995.0, 995.0, 997.0, 997.0, 999.0, 995.0, 995.0, 997.0, 995.0, 995.0, 999.0, 995.0, 999.0, 997.0, 993.0, 991.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3449621681889146, "mean_inference_ms": 1.1155245591515621, "mean_action_processing_ms": 0.12306506630037918, "mean_env_wait_ms": 0.48770712459995796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.002984502422275828, "ObsPreprocessorConnector_ms": 0.0029837907250247785, "MeanStdObservationFilterAgentConnector_ms": 0.06420968183830603, "StateBufferConnector_ms": 0.0059234562204844915, "ViewRequirementAgentConnector_ms": 0.11198734169575705}}, "episode_reward_max": 999.0, "episode_reward_min": -44.0, "episode_reward_mean": 807.7611940298508, "episode_len_mean": 949.8358208955224, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0, -4.0, -44.0, -21.0, -29.0, -36.0, -1.0, 237.0, 355.0, 393.0, 349.0, 599.0, 753.0, 719.0, 733.0, 803.0, 847.0, 821.0, 825.0, 871.0, 909.0, 907.0, 905.0, 915.0, 921.0, 923.0, 945.0, 951.0, 977.0, 975.0, 963.0, 975.0, 983.0, 977.0, 975.0, 985.0, 979.0, 983.0, 987.0, 989.0, 985.0, 989.0, 993.0, 993.0, 993.0, 993.0, 993.0, 991.0, 989.0, 989.0, 987.0, 995.0, 995.0, 997.0, 997.0, 999.0, 995.0, 995.0, 997.0, 995.0, 995.0, 999.0, 995.0, 999.0, 997.0, 993.0, 991.0], "episode_lengths": [520, 531, 519, 514, 524, 509, 522, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3449621681889146, "mean_inference_ms": 1.1155245591515621, "mean_action_processing_ms": 0.12306506630037918, "mean_env_wait_ms": 0.48770712459995796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ClipRewardAgentConnector_ms": 0.002984502422275828, "ObsPreprocessorConnector_ms": 0.0029837907250247785, "MeanStdObservationFilterAgentConnector_ms": 0.06420968183830603, "StateBufferConnector_ms": 0.0059234562204844915, "ViewRequirementAgentConnector_ms": 0.11198734169575705}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 13004.904, "load_time_ms": 0.499, "load_throughput": 8018935.092, "learn_time_ms": 5271.505, "learn_throughput": 758.797, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": true, "episodes_total": 67, "training_iteration": 16, "trial_id": "cf167_00000", "experiment_id": "cf2183a860304799b469a9e50cfde37b", "date": "2023-03-20_11-07-24", "timestamp": 1679281644, "time_this_iter_s": 13.21602463722229, "time_total_s": 212.2248740196228, "pid": 17932, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv", "env_config": {"window_size": 25}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": true, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x0000022C5A8FB730>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "DEBUG", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [100, 0.01], [1000, 0.001], [10000, 0.0001], [100000, 1e-05], [1000000, 1e-06], [10000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.72, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x0000022C5A6DA550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 212.2248740196228, "timesteps_since_restore": 0, "iterations_since_restore": 16, "warmup_time": 6.7070534229278564, "perf": {"cpu_util_percent": 29.355555555555554, "ram_util_percent": 57.85555555555555}}
